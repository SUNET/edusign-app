
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>edusign_webapp.document.metadata package &#8212; eduSign app 1.0.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="edusign-webapp-document-metadata-package">
<h1>edusign_webapp.document.metadata package<a class="headerlink" href="#edusign-webapp-document-metadata-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-edusign_webapp.document.metadata.redis_client">
<span id="edusign-webapp-document-metadata-redis-client-module"></span><h2>edusign_webapp.document.metadata.redis_client module<a class="headerlink" href="#module-edusign_webapp.document.metadata.redis_client" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">edusign_webapp.document.metadata.redis_client.</span></span><span class="sig-name descname"><span class="pre">RedisMD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">flask.app.Flask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="edusign_webapp.html#edusign_webapp.doc_store.ABCMetadata" title="edusign_webapp.doc_store.ABCMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">edusign_webapp.doc_store.ABCMetadata</span></code></a></p>
<p>Redis backend to deal with the metadata associated to documents
to be signed by more than one user.</p>
<p>This metadata includes data about the document (name, size, type),
data about its owner (who has uploaded the document and invited other users to sign it),
and data about the users who have been invited to sign the document.</p>
<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">document</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invites</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Store metadata for a new document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The uuid that uniquely identifies the document in the storage.</p></li>
<li><p><strong>document</strong> – Content and metadata of the document. Dictionary containing 4 keys:
+ name: The name of the document
+ size: Size of the doc
+ type: Content type of the doc
+ prev_signatures: previous signatures</p></li>
<li><p><strong>owner</strong> – Name and email address of the user that has uploaded the document.</p></li>
<li><p><strong>invites</strong> – List of the names and emails of the users that have been invited to sign the document.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The list of invitations as dicts with 3 keys: name, email, and generated key (UUID)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.add_lock">
<span class="sig-name descname"><span class="pre">add_lock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locked_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.add_lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Lock document to avoid it being signed by more than one invitee in parallel.
This will first check that the doc is not already locked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doc_id</strong> – the pk for the document in the documents table</p></li>
<li><p><strong>locked_by</strong> – Email of the user locking the document</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the document has been locked.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.check_lock">
<span class="sig-name descname"><span class="pre">check_lock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locked_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.check_lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the document identified by doc_id is locked.
This will remove stale locks (older than the configured timeout).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doc_id</strong> – the pk for the document in the documents table</p></li>
<li><p><strong>locked_by</strong> – Email of the user locking the document</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the document is locked by the user with <cite>locked_by</cite> email</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.decline">
<span class="sig-name descname"><span class="pre">decline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">email</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.decline" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the metadata of a document which an invited user has declined to sign.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key identifying the document in the <cite>storage</cite>.</p></li>
<li><p><strong>email</strong> – email address of the user that has just signed the document.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.get_document">
<span class="sig-name descname"><span class="pre">get_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.get_document" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about some document</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – The key identifying the document</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary with information about the document, with keys:
+ doc_id: pk of the doc in the storage.
+ key: Key of the doc in the storage.
+ name: The name of the document
+ type: Content type of the doc
+ size: Size of the doc</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.get_invitation">
<span class="sig-name descname"><span class="pre">get_invitation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.get_invitation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the invited user’s name and email and the data on the document she’s been invited to sign</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – The key identifying the signing invitation</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dict with data on the user and the document</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.get_invited">
<span class="sig-name descname"><span class="pre">get_invited</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.get_invited" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about the users that have been invited to sign the document identified by <cite>key</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – The key of the document</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of dictionaries with information about the users, each of them with keys:
+ name: The name of the user
+ email: The email of the user
+ signed: Whether the user has already signed the document
+ key: the key identifying the invite</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.get_owned">
<span class="sig-name descname"><span class="pre">get_owned</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">email</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.get_owned" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about the documents that have been added by some user to be signed by other users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>email</strong> – The email of the user</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of dictionaries with information about the documents, each of them with keys:
+ key: Key of the doc in the storage.
+ name: The name of the document
+ type: Content type of the doc
+ size: Size of the doc
+ pending: List of emails of the users invited to sign the document who have not yet done so.
+ signed: List of emails of the users invited to sign the document who have already done so.
+ state: the state of the invitation
+ declined: List of emails of the users invited to sign the document who have declined to do so.
+ prev_signatures: previous signatures</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.get_pending">
<span class="sig-name descname"><span class="pre">get_pending</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">email</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.get_pending" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the email address of some user, return information about the documents
she has been invited to sign, and has not yet signed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>email</strong> – The email of the user</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of dictionaries with information about the documents pending to be signed,
each of them with keys:
+ key: Key of the doc in the storage.
+ name: The name of the document
+ size: Size of the doc
+ type: Content type of the doc
+ owner: Email and name of the user requesting the signature
+ state: the state of the invitation
+ pending: List of emails of the users invited to sign the document who have not yet done so.
+ signed: List of emails of the users invited to sign the document who have already done so.
+ declined: List of emails of the users invited to sign the document who have declined to do so.
+ prev_signatures: previous signatures</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.get_user">
<span class="sig-name descname"><span class="pre">get_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.get_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Return information on some user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>user_id</strong> – the pk for the user in the users table</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Name and email of the user</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.remove">
<span class="sig-name descname"><span class="pre">remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove from the store the metadata corresponding to the document identified by the <cite>key</cite>,
typically because it has already been signed by all requested parties and has been handed to the owner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key identifying the document.</p></li>
<li><p><strong>force</strong> – whether to remove the doc even if there are pending signatures</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>whether the document has been removed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.rm_lock">
<span class="sig-name descname"><span class="pre">rm_lock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unlocked_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.rm_lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove lock from document. If the document is not locked, do nothing.
The user unlocking must be that same user that locked it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doc_id</strong> – the pk for the document in the documents table</p></li>
<li><p><strong>unlocked_by</strong> – Email of the user unlocking the document</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the document has been unlocked.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisMD.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">email</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisMD.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the metadata of a document to which a new signature has been added.
This is, remove corresponding entry in the Invites table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key identifying the document in the <cite>storage</cite>.</p></li>
<li><p><strong>email</strong> – email address of the user that has just signed the document.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">edusign_webapp.document.metadata.redis_client.</span></span><span class="sig-name descname"><span class="pre">RedisStorageBackend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redis_client</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.abort">
<span class="sig-name descname"><span class="pre">abort</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.abort" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.add_document_lock">
<span class="sig-name descname"><span class="pre">add_document_lock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locked</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locked_by</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.add_document_lock" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.commit">
<span class="sig-name descname"><span class="pre">commit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.commit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.decline_invite">
<span class="sig-name descname"><span class="pre">decline_invite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doc_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.decline_invite" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.delete_document">
<span class="sig-name descname"><span class="pre">delete_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.delete_document" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.delete_invites_all">
<span class="sig-name descname"><span class="pre">delete_invites_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.delete_invites_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.insert_document">
<span class="sig-name descname"><span class="pre">insert_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prev_signatures</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.insert_document" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.insert_invite">
<span class="sig-name descname"><span class="pre">insert_invite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doc_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.insert_invite" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.insert_user">
<span class="sig-name descname"><span class="pre">insert_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">email</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.insert_user" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.pipeline">
<span class="sig-name descname"><span class="pre">pipeline</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.pipeline" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_document">
<span class="sig-name descname"><span class="pre">query_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_document" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_document_all">
<span class="sig-name descname"><span class="pre">query_document_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_document_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_document_id">
<span class="sig-name descname"><span class="pre">query_document_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_document_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_document_lock">
<span class="sig-name descname"><span class="pre">query_document_lock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_document_lock" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_documents_from_owner">
<span class="sig-name descname"><span class="pre">query_documents_from_owner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">email</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_documents_from_owner" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_invite_from_key">
<span class="sig-name descname"><span class="pre">query_invite_from_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_invite_from_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_invite_id">
<span class="sig-name descname"><span class="pre">query_invite_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_invite_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_invites_from_doc">
<span class="sig-name descname"><span class="pre">query_invites_from_doc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_invites_from_doc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_invites_from_email">
<span class="sig-name descname"><span class="pre">query_invites_from_email</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">email</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_invites_from_email" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_unsigned_invites_from_doc">
<span class="sig-name descname"><span class="pre">query_unsigned_invites_from_doc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_unsigned_invites_from_doc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_user">
<span class="sig-name descname"><span class="pre">query_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_user" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_user_id">
<span class="sig-name descname"><span class="pre">query_user_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">email</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.query_user_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.rm_document_lock">
<span class="sig-name descname"><span class="pre">rm_document_lock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.rm_document_lock" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.update_document">
<span class="sig-name descname"><span class="pre">update_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">updated</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.update_document" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.redis_client.RedisStorageBackend.update_invite">
<span class="sig-name descname"><span class="pre">update_invite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doc_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.redis_client.RedisStorageBackend.update_invite" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-edusign_webapp.document.metadata.sqlite">
<span id="edusign-webapp-document-metadata-sqlite-module"></span><h2>edusign_webapp.document.metadata.sqlite module<a class="headerlink" href="#module-edusign_webapp.document.metadata.sqlite" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">edusign_webapp.document.metadata.sqlite.</span></span><span class="sig-name descname"><span class="pre">SqliteMD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">flask.app.Flask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="edusign_webapp.html#edusign_webapp.doc_store.ABCMetadata" title="edusign_webapp.doc_store.ABCMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">edusign_webapp.doc_store.ABCMetadata</span></code></a></p>
<p>Sqlite backend to deal with the metadata associated to documents
to be signed by more than one user.</p>
<p>This metadata includes data about the document (name, size, type),
data about its owner (who has uploaded the document and invited other users to sign it),
and data about the users who have been invited to sign the document.</p>
<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">document</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invites</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Store metadata for a new document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The uuid that uniquely identifies the document in the storage.</p></li>
<li><p><strong>document</strong> – Content and metadata of the document. Dictionary containing 4 keys:
+ name: The name of the document
+ size: Size of the doc
+ type: Content type of the doc
+ prev_signatures: previous signatures</p></li>
<li><p><strong>owner</strong> – Name and email address of the user that has uploaded the document.</p></li>
<li><p><strong>invites</strong> – List of the names and emails of the users that have been invited to sign the document.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The list of invitations as dicts with 3 keys: name, email, and generated key (UUID)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.add_lock">
<span class="sig-name descname"><span class="pre">add_lock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locked_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.add_lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Lock document to avoid it being signed by more than one invitee in parallel.
This will first check that the doc is not already locked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doc_id</strong> – the pk for the document in the documents table</p></li>
<li><p><strong>locked_by</strong> – Email of the user locking the document</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the document has been locked.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.check_lock">
<span class="sig-name descname"><span class="pre">check_lock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locked_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.check_lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the document identified by doc_id is locked.
This will remove stale locks (older than the configured timeout).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doc_id</strong> – the pk for the document in the documents table</p></li>
<li><p><strong>locked_by</strong> – Email of the user locking the document</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the document is locked by the user with <cite>locked_by</cite> email</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.decline">
<span class="sig-name descname"><span class="pre">decline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">email</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.decline" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the metadata of a document which an invited user has declined to sign.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key identifying the document in the <cite>storage</cite>.</p></li>
<li><p><strong>email</strong> – email address of the user that has just signed the document.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.get_document">
<span class="sig-name descname"><span class="pre">get_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.get_document" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about some document</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – The key identifying the document</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary with information about the document, with keys:
+ doc_id: pk of the doc in the storage.
+ key: Key of the doc in the storage.
+ name: The name of the document
+ type: Content type of the doc
+ size: Size of the doc</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.get_invitation">
<span class="sig-name descname"><span class="pre">get_invitation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.get_invitation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the invited user’s name and email and the data on the document she’s been invited to sign</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – The key identifying the signing invitation</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dict with data on the user and the document</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.get_invited">
<span class="sig-name descname"><span class="pre">get_invited</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.get_invited" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about the users that have been invited to sign the document identified by <cite>key</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – The key of the document</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of dictionaries with information about the users, each of them with keys:
+ name: The name of the user
+ email: The email of the user
+ signed: Whether the user has already signed the document
+ key: the key identifying the invite</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.get_owned">
<span class="sig-name descname"><span class="pre">get_owned</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">email</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.get_owned" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about the documents that have been added by some user to be signed by other users.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>email</strong> – The email of the user</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of dictionaries with information about the documents, each of them with keys:
+ key: Key of the doc in the storage.
+ name: The name of the document
+ type: Content type of the doc
+ size: Size of the doc
+ pending: List of emails of the users invited to sign the document who have not yet done so.
+ signed: List of emails of the users invited to sign the document who have already done so.
+ state: the state of the invitation
+ declined: List of emails of the users invited to sign the document who have declined to do so.
+ prev_signatures: previous signatures</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.get_pending">
<span class="sig-name descname"><span class="pre">get_pending</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">email</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.get_pending" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the email address of some user, return information about the documents
she has been invited to sign, and has not yet signed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>email</strong> – The email of the user</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of dictionaries with information about the documents pending to be signed,
each of them with keys:
+ key: Key of the doc in the storage.
+ name: The name of the document
+ size: Size of the doc
+ type: Content type of the doc
+ owner: Email and name of the user requesting the signature
+ state: the state of the invitation
+ pending: List of emails of the users invited to sign the document who have not yet done so.
+ signed: List of emails of the users invited to sign the document who have already done so.
+ declined: List of emails of the users invited to sign the document who have declined to do so.
+ prev_signatures: previous signatures</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.get_user">
<span class="sig-name descname"><span class="pre">get_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.get_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Return information on some user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>user_id</strong> – the pk for the user in the users table</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Name and email of the user</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.remove">
<span class="sig-name descname"><span class="pre">remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove from the store the metadata corresponding to the document identified by the <cite>key</cite>,
typically because it has already been signed by all requested parties and has been handed to the owner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key identifying the document.</p></li>
<li><p><strong>force</strong> – whether to remove the doc even if there are pending signatures</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>whether the document has been removed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.rm_lock">
<span class="sig-name descname"><span class="pre">rm_lock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unlocked_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.rm_lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove lock from document. If the document is not locked, do nothing.
The user unlocking must be that same user that locked it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doc_id</strong> – the pk for the document in the documents table</p></li>
<li><p><strong>unlocked_by</strong> – Email of the user unlocking the document</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the document has been unlocked.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.SqliteMD.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">email</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.SqliteMD.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the metadata of a document to which a new signature has been added.
This is, remove corresponding entry in the Invites table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The key identifying the document in the <cite>storage</cite>.</p></li>
<li><p><strong>email</strong> – email address of the user that has just signed the document.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.close_connection">
<span class="sig-prename descclassname"><span class="pre">edusign_webapp.document.metadata.sqlite.</span></span><span class="sig-name descname"><span class="pre">close_connection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exception</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.close_connection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.get_db">
<span class="sig-prename descclassname"><span class="pre">edusign_webapp.document.metadata.sqlite.</span></span><span class="sig-name descname"><span class="pre">get_db</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.get_db" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.make_dicts">
<span class="sig-prename descclassname"><span class="pre">edusign_webapp.document.metadata.sqlite.</span></span><span class="sig-name descname"><span class="pre">make_dicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cursor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.make_dicts" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference external" href="https://flask.palletsprojects.com/en/1.1.x/patterns/sqlite3">https://flask.palletsprojects.com/en/1.1.x/patterns/sqlite3</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="edusign_webapp.document.metadata.sqlite.upgrade">
<span class="sig-prename descclassname"><span class="pre">edusign_webapp.document.metadata.sqlite.</span></span><span class="sig-name descname"><span class="pre">upgrade</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#edusign_webapp.document.metadata.sqlite.upgrade" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-edusign_webapp.document.metadata">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-edusign_webapp.document.metadata" title="Permalink to this headline">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">eduSign app</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Enrique Pérez Arnaud.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/python/edusign_webapp.document.metadata.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>